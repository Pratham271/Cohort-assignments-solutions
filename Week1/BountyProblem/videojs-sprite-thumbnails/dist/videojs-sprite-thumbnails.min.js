/*! @name videojs-sprite-thumbnails @version 2.2.1 @license MIT */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsSpriteThumbnails=t(e.videojs)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);const n=o.default.getPlugin("plugin"),r={url:"",idxTag:e=>e,urlArray:[],width:0,height:0,columns:0,rows:0,interval:1,responsive:600,downlink:1.5};class i extends n{constructor(e,t){super(e,t),this.options=o.default.obj.merge(r,t),this.player.ready((()=>{((e,t,n)=>{const r=window.navigator,i=o.default.dom,s=o.default.obj,l=s.merge,a=t.log,u=e.controlBar,d=u&&u.progressControl,c=d&&d.seekBar,h=c&&c.mouseTimeDisplay&&c.mouseTimeDisplay.timeTooltip,p=h&&h.el(),g=p&&p.style,f=e=>{const t=n.urlArray;return t.length?t[e]:n.url.replace("{index}",n.idxTag(e))},y=t=>{const o=c.el(),r=e.currentWidth(),l=e.duration(),a=n.interval,d=n.columns,h=n.responsive,g=a*d,y=g*(n.rows||Math.ceil(l/g));let m=i.getPointerPosition(o,t).x*l;const b=Math.floor(m/y);m=(m-y*b)/a;const w=h&&r<h?r/h:1,x=n.width*w,v=n.height*w,j=Math.floor(m%d)*-x,k=Math.floor(m/d)*-v,T=i.findPosition(u.el()).top,$=i.findPosition(o).top,P=-v-Math.max(0,$-T),A={backgroundImage:`url("${f(b)}")`,backgroundRepeat:"no-repeat",backgroundPosition:`${j}px ${k}px`,backgroundSize:x*d+"px auto",top:`${P}px`,color:"#fff",textShadow:"1px 1px #000",border:"1px solid #000",width:`${x+2}px`,height:`${v+2}px`};s.each(A,((e,t)=>{p.style[t]=e}))},m=e=>{const t=n[e],o="rows"!==e?1:0;return!(parseInt(t,10)!==t||t<o)||(a(`${e} must be an integer greater than ${o-1}`),!1)},b=()=>{const e=r.connection||r.mozConnection||r.webkitConnection,t=n.downlink;return!(e&&e.downlink<t&&(a.warn(`connection.downlink < ${t}`),1))};t.on("statechanged",(()=>{const o=t.state,r=["mousemove","touchmove"],i=a.debug;o.ready?(i("ready to show thumbnails"),d.on(r,y)):(n.url||n.urlArray.length||a("no urls given"),i("resetting"),d.off(r,y),p.style=g),e.toggleClass("vjs-thumbnails-ready",o.ready)}));const w=()=>{const o=t.name,r=e.currentSources().find((e=>e.hasOwnProperty(o)));let i=r&&r[o];if(i){const e=i.urlArray;Object.keys(i).length?e&&e.length?i.url="":i.url&&(i.urlArray=[]):(i={url:"",urlArray:[]},a("disabling plugin")),t.options=n=l(n,i)}t.setState({ready:!!(h&&(n.urlArray.length||n.url)&&m("width")&&m("height")&&m("columns")&&m("rows")&&b())})};e.on("loadstart",w),w(),e.addClass("vjs-sprite-thumbnails")})(this.player,this,this.options)}))}}return i.defaultState={ready:!1},i.VERSION="2.2.1",o.default.registerPlugin("spriteThumbnails",i),i}));
